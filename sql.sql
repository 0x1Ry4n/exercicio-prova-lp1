WITH Semanas AS (
    SELECT $P{DHINICIO}  + (LEVEL - 1) * 7 AS DHINICIO
    FROM DUAL
    CONNECT BY LEVEL <= 5
),
Dias AS (
    SELECT DHINICIO + (NIVEL - 1) AS DIA_COMPLETO
    FROM Semanas, LATERAL (
        SELECT LEVEL AS NIVEL
        FROM DUAL
        CONNECT BY LEVEL <= 7
    )
),
Anodizacao AS (
    SELECT
        MAX(T.CODPLP) AS CODPLP,
        T.TURNO AS COD_TURNO,
        TRUNC(T.DHINICIO) AS DIA,
        ROUND(SUM(T.PESOLOTE), 2) AS PESOLOTE,
        ROUND(SUM(T.BARRAS), 2) AS BARRAS,
        ROUND(SUM(T.BARRASNC), 2) AS BARRASNC,
        ROUND(SUM(PESOLOTE) / NULLIF(SUM(BARRAS), 0), 2) AS PESOMEDIO,
        ROUND(MAX(T.HRPARADA), 2) AS HRPARADA,
        ROUND(
            100.0 * COUNT(CASE WHEN T.DESCRTIPOACAB LIKE '%FOSCO%' THEN 1 END) /
            NULLIF(COUNT(T.CODPLP), 0), 2
        ) AS PERC_FOSCO,
        ROUND(
            100.0 * COUNT(CASE WHEN T.DESCRTIPOACAB NOT LIKE '%FOSCO%' THEN 1 END) /
            NULLIF(COUNT(T.CODPLP), 0), 2
        ) AS PERC_COLORIDO,
        (
            SELECT
                SUM(TUR.CAPACIDADE)
            FROM AD_PROGCAPACIDADE CAP
            INNER JOIN AD_PROGTURNOS TUR ON CAP.ID = TUR.ID
            WHERE CAP.CODEMP = $P{CODEMP} AND CAP.ID = 20
            GROUP BY TUR.ID
        ) AS META,
        (
            SELECT
                MAX(TUR.CAPACIDADE)
            FROM AD_PROGCAPACIDADE CAP
            INNER JOIN AD_PROGTURNOS TUR ON CAP.ID = TUR.ID
            WHERE CAP.CODEMP = $P{CODEMP} AND CAP.ID = 20  AND TUR.CODTURNO = 1
            GROUP BY TUR.ID
        ) AS META_TURNO_1,
         (
            SELECT
                MAX(TUR.CAPACIDADE)
            FROM AD_PROGCAPACIDADE CAP
            INNER JOIN AD_PROGTURNOS TUR ON CAP.ID = TUR.ID
            WHERE CAP.CODEMP = $P{CODEMP} AND CAP.ID = 20 AND TUR.CODTURNO = 2
            GROUP BY TUR.ID
        ) AS META_TURNO_2,
        0 AS META_TURNO_3,
        T.CODEMP AS CODEMP
    FROM (
        SELECT
            APO.CODPLP AS CODPLP,
            APO.QTDBARRAS AS BARRAS,
            APO.DATA_APONTAMENTO AS DHINICIO,
            APO.TURNO AS TURNO,
            NVL(SUM(NC.QTDE), 0) AS BARRASNC,
            ROUND(APO.QTDNEG, 4) AS PESOLOTE,
             (
                SELECT SUM(ROUND((PL.DTRET - PL.DTINI) * 24, 2))
                FROM AD_PLINHA PL
                WHERE PL.LPROC = 'A'
                AND TO_DATE(PL.DTRET, 'DD/MM/YYYY') = TO_DATE(APO.DATA_APONTAMENTO, 'DD/MM/YYYY')
                AND PL.STATUS = 'Finalizado'
            ) AS HRPARADA,
            TIPACAB.DESCRTIPOACAB AS DESCRTIPOACAB,
            CAB.CODEMP
        FROM
            AD_APPAPONTAMENTO APO
        INNER JOIN
            TGFCAB CAB ON CAB.NUNOTA = APO.NUNOTA
        LEFT JOIN
            AD_RELDEVNC NC ON NC.NUNOTA = CAB.NUNOTA AND NC.TIPO = 'NC'
        LEFT JOIN AD_TIPACAB TIPACAB ON TIPACAB.CODTIPACAB = CAB.AD_CODTIPACAB
        WHERE
            APO.DATA_APONTAMENTO >= $P{DHINICIO}
            AND APO.DATA_APONTAMENTO <= $P{DHFIM}
            AND CAB.CODEMP = $P{CODEMP}
            AND APO.CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR = 1)
            AND APO.SETOR LIKE '%ABASTECIMENTO%'
            AND APO.TURNO IN (1, 2, 3)
            AND APO.SESSAO = 4
            AND APO.QTDBARRAS >= 0
        GROUP BY
            APO.CODPLP,
            APO.QTDBARRAS,
            APO.DATA_APONTAMENTO,
            APO.TURNO,
            APO.QTDNEG,
            TIPACAB.DESCRTIPOACAB,
            CAB.CODEMP
    ) T
    GROUP BY TRUNC(T.DHINICIO), T.TURNO, T.CODPLP, T.CODEMP
),
Vertical AS (
    SELECT
        MAX(T.CODPLP) AS CODPLP,
        T.TURNO  AS COD_TURNO,
        TRUNC(T.DHINICIO) AS DIA,
        ROUND(SUM(T.PESOLOTE), 2) AS PESOLOTE,
        ROUND(SUM(T.BARRAS), 2) AS BARRAS,
        ROUND(SUM(T.BARRASNC), 2) AS BARRASNC,
        ROUND(SUM(PESOLOTE) / NULLIF(SUM(BARRAS), 0), 2) AS PESOMEDIO,
        ROUND(MAX(T.HRPARADA), 2) AS HRPARADA,
        0 AS PERC_FOSCO,
        0 AS PERC_COLORIDO,
        (
            SELECT
                SUM(TUR.CAPACIDADE)
            FROM AD_PROGCAPACIDADE CAP
            INNER JOIN AD_PROGTURNOS TUR ON CAP.ID = TUR.ID
            WHERE CAP.NOMEMAQUINA LIKE '%VERTICAL%'
            AND CAP.CODEMP = $P{CODEMP}
            GROUP BY TUR.ID
        ) AS META,
        (
            SELECT
                MAX(TUR.CAPACIDADE)
            FROM AD_PROGCAPACIDADE CAP
            INNER JOIN AD_PROGTURNOS TUR ON CAP.ID = TUR.ID
            WHERE CAP.CODEMP = $P{CODEMP} AND CAP.ID = 21  AND TUR.CODTURNO = 1
            GROUP BY TUR.ID
        ) AS META_TURNO_1,
         (
            SELECT
                MAX(TUR.CAPACIDADE)
            FROM AD_PROGCAPACIDADE CAP
            INNER JOIN AD_PROGTURNOS TUR ON CAP.ID = TUR.ID
            WHERE CAP.CODEMP = $P{CODEMP} AND CAP.ID = 21  AND TUR.CODTURNO = 2
            GROUP BY TUR.ID
        ) AS META_TURNO_2,
        (
            SELECT
                MAX(TUR.CAPACIDADE)
            FROM AD_PROGCAPACIDADE CAP
            INNER JOIN AD_PROGTURNOS TUR ON CAP.ID = TUR.ID
            WHERE CAP.CODEMP = $P{CODEMP} AND CAP.ID = 21  AND TUR.CODTURNO = 3
            GROUP BY TUR.ID
        ) AS META_TURNO_3,
        T.CODEMP AS CODEMP
    FROM (
           SELECT
            APO.CODPLP AS CODPLP,
            APO.QTDBARRAS AS BARRAS,
            APO.DATA_APONTAMENTO AS DHINICIO,
            APO.TURNO AS TURNO,
            NVL(SUM(NC.QTDE), 0) AS BARRASNC,
            ROUND(APO.QTDNEG, 4) AS PESOLOTE,
            (
                SELECT SUM(ROUND((PL.DTRET - PL.DTINI) * 24, 2))
                FROM AD_PLINHA PL
                WHERE PL.LPROC = 'V'
                AND TO_DATE(PL.DTRET, 'DD/MM/YYYY') = TO_DATE(APO.DATA_APONTAMENTO, 'DD/MM/YYYY')
                AND PL.STATUS = 'Finalizado'
            ) AS HRPARADA,
            CAB.CODEMP
        FROM
            AD_APPAPONTAMENTO APO
        INNER JOIN
            TGFCAB CAB ON CAB.NUNOTA = APO.NUNOTA
        LEFT JOIN
            AD_RELDEVNC NC ON NC.NUNOTA = CAB.NUNOTA AND NC.TIPO = 'NC'
        WHERE
            APO.DATA_APONTAMENTO >= $P{DHINICIO}
            AND APO.DATA_APONTAMENTO <= $P{DHFIM}
            AND CAB.CODEMP = $P{CODEMP}
            AND APO.CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR = 3)
            AND APO.SETOR LIKE '%ABASTECIMENTO%'
            AND APO.TURNO IN (1, 2, 3)
            AND APO.SESSAO = 4
            AND APO.QTDBARRAS >= 0
        GROUP BY
            APO.CODPLP,
            APO.QTDBARRAS,
            APO.DATA_APONTAMENTO,
            APO.TURNO,
            APO.QTDNEG,
            CAB.CODEMP
    ) T
    GROUP BY TRUNC(T.DHINICIO), T.TURNO, T.CODPLP, T.CODEMP
),
Horizontal AS (
    SELECT
        MAX(T.CODPLP) AS CODPLP,
        T.TURNO  AS COD_TURNO,
        TRUNC(T.DHINICIO) AS DIA,
        ROUND(SUM(T.PESOLOTE), 2) AS PESOLOTE,
        ROUND(SUM(T.BARRAS), 2) AS BARRAS,
        ROUND(SUM(T.BARRASNC), 2) AS BARRASNC,
        ROUND(SUM(PESOLOTE) / NULLIF(SUM(BARRAS), 0), 2) AS PESOMEDIO,
        ROUND(MAX(T.HRPARADA), 2) AS HRPARADA,
        0 AS PERC_FOSCO,
        0 AS PERC_COLORIDO,
        (
            SELECT
                SUM(TUR.CAPACIDADE)
            FROM AD_PROGCAPACIDADE CAP
            INNER JOIN AD_PROGTURNOS TUR ON CAP.ID = TUR.ID
            WHERE CAP.CODEMP = $P{CODEMP} AND CAP.ID IN (23, 25)
            GROUP BY TUR.ID
        ) AS META,
        (
            SELECT
                MAX(TUR.CAPACIDADE)
            FROM AD_PROGCAPACIDADE CAP
            INNER JOIN AD_PROGTURNOS TUR ON CAP.ID = TUR.ID
            WHERE CAP.CODEMP = $P{CODEMP} AND CAP.ID IN (23, 25)  AND TUR.CODTURNO = 1
            GROUP BY TUR.ID
        ) AS META_TURNO_1,
         (
            SELECT
                MAX(TUR.CAPACIDADE)
            FROM AD_PROGCAPACIDADE CAP
            INNER JOIN AD_PROGTURNOS TUR ON CAP.ID = TUR.ID
            WHERE CAP.CODEMP = $P{CODEMP} AND CAP.ID IN (23, 25)  AND TUR.CODTURNO = 2
            GROUP BY TUR.ID
        ) AS META_TURNO_2,
        0 AS META_TURNO_3,
        T.CODEMP AS CODEMP
    FROM (
           SELECT
            APO.CODPLP AS CODPLP,
            APO.QTDBARRAS AS BARRAS,
            APO.DATA_APONTAMENTO AS DHINICIO,
            APO.TURNO AS TURNO,
            NVL(SUM(NC.QTDE), 0) AS BARRASNC,
            ROUND(APO.QTDNEG, 4) AS PESOLOTE,
            (
                SELECT SUM(ROUND((PL.DTRET - PL.DTINI) * 24, 2))
                FROM AD_PLINHA PL
                WHERE PL.LPROC = 'H'
                AND TO_DATE(PL.DTRET, 'DD/MM/YYYY') = TO_DATE(APO.DATA_APONTAMENTO, 'DD/MM/YYYY')
                AND PL.STATUS = 'Finalizado'
            ) AS HRPARADA,
            CAB.CODEMP
        FROM
            AD_APPAPONTAMENTO APO
        INNER JOIN
            TGFCAB CAB ON CAB.NUNOTA = APO.NUNOTA
        LEFT JOIN
            AD_RELDEVNC NC ON NC.NUNOTA = CAB.NUNOTA AND NC.TIPO = 'NC'
        WHERE
            APO.DATA_APONTAMENTO >= $P{DHINICIO}
            AND APO.DATA_APONTAMENTO <= $P{DHFIM}
            AND CAB.CODEMP = $P{CODEMP}
            AND APO.CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4))
            AND APO.SETOR LIKE '%ABASTECIMENTO%'
            AND APO.TURNO IN (1, 2, 3)
            AND APO.SESSAO = 4
            AND APO.QTDBARRAS >= 0
        GROUP BY
            APO.CODPLP,
            APO.QTDBARRAS,
            APO.DATA_APONTAMENTO,
            APO.TURNO,
            APO.QTDNEG,
            CAB.CODEMP
    ) T
    GROUP BY TRUNC(T.DHINICIO), T.TURNO, T.CODPLP, T.CODEMP
),
Madeira AS (
    SELECT
        MAX(T.CODPLP) AS CODPLP,
        T.TURNO AS COD_TURNO,
        TRUNC(T.DHINICIO) AS DIA,
        ROUND(SUM(T.PESOLOTE), 2) AS PESOLOTE,
        ROUND(SUM(T.BARRAS), 2) AS BARRAS,
        ROUND(SUM(T.BARRASNC), 2) AS BARRASNC,
        ROUND(SUM(PESOLOTE) / NULLIF(SUM(BARRAS), 0), 2) AS PESOMEDIO,
        ROUND(MAX(T.HRPARADA), 2) AS HRPARADA,
        0 AS PERC_FOSCO,
        0 AS PERC_COLORIDO,
        (
            SELECT
                SUM(TUR.CAPACIDADE)
            FROM AD_PROGCAPACIDADE CAP
            INNER JOIN AD_PROGTURNOS TUR ON CAP.ID = TUR.ID
            WHERE CAP.CODEMP = $P{CODEMP} AND CAP.ID IN (22, 28)
            GROUP BY TUR.ID
        ) AS META,
        (
            SELECT
                MAX(TUR.CAPACIDADE)
            FROM AD_PROGCAPACIDADE CAP
            INNER JOIN AD_PROGTURNOS TUR ON CAP.ID = TUR.ID
            WHERE CAP.CODEMP = $P{CODEMP} AND CAP.ID IN (22, 28) AND TUR.CODTURNO = 1
            GROUP BY TUR.ID
        ) AS META_TURNO_1,
        (
            SELECT
                MAX(TUR.CAPACIDADE)
            FROM AD_PROGCAPACIDADE CAP
            INNER JOIN AD_PROGTURNOS TUR ON CAP.ID = TUR.ID
            WHERE CAP.CODEMP = $P{CODEMP} AND CAP.ID IN (22, 28) AND TUR.CODTURNO = 2
            GROUP BY TUR.ID
        ) AS META_TURNO_2,
        0 AS META_TURNO_3,
        T.CODEMP
    FROM (
           SELECT
            APO.CODPLP AS CODPLP,
            APO.QTDBARRAS AS BARRAS,
            APO.DATA_APONTAMENTO AS DHINICIO,
            APO.TURNO AS TURNO,
            NVL(SUM(NC.QTDE), 0) AS BARRASNC,
            ROUND(APO.QTDNEG, 4) AS PESOLOTE,
            (
                SELECT SUM(ROUND((PL.DTRET - PL.DTINI) * 24, 2))
                FROM AD_PLINHA PL
                WHERE PL.LPROC = 'M'
                AND TO_DATE(PL.DTRET, 'DD/MM/YYYY') = TO_DATE(APO.DATA_APONTAMENTO, 'DD/MM/YYYY')
                AND PL.STATUS = 'Finalizado'
            ) AS HRPARADA,
            CAB.CODEMP
        FROM
            AD_APPAPONTAMENTO APO
        INNER JOIN
            TGFCAB CAB ON CAB.NUNOTA = APO.NUNOTA
        LEFT JOIN
            AD_RELDEVNC NC ON NC.NUNOTA = CAB.NUNOTA AND NC.TIPO = 'NC'
        WHERE
            APO.DATA_APONTAMENTO >= $P{DHINICIO}
            AND APO.DATA_APONTAMENTO <= $P{DHFIM}
            AND CAB.CODEMP = $P{CODEMP}
            AND APO.CODPLP IN (22, 28)
            AND APO.SETOR LIKE '%ABASTECIMENTO%'
            AND APO.TURNO IN (1, 2, 3)
            AND APO.SESSAO = 4
            AND APO.QTDBARRAS >= 0
        GROUP BY
            APO.CODPLP,
            APO.QTDBARRAS,
            APO.DATA_APONTAMENTO,
            APO.TURNO,
            APO.QTDNEG,
            CAB.CODEMP
    ) T
    GROUP BY TRUNC(T.DHINICIO), T.TURNO, T.CODPLP, T.CODEMP
),
MontagemRack AS (
    SELECT
        0 AS CODPLP,
        T.COD_TURNO AS COD_TURNO,
        TRUNC(T.DATAINI) AS DIA,
        ROUND(SUM(T.PESO), 2) AS PESOLOTE,
        ROUND(MAX(T.HRPARADA), 2) AS HRPARADA,
        0 AS BARRAS,
        0 AS BARRASNC,
        0 AS PESOMEDIO,
        0 AS META,
        0 AS META_TURNO_1,
        0 AS META_TURNO_2,
        0 AS META_TURNO_3,
        0 AS PERC_FOSCO,
        0 AS PERC_COLORIDO,
        0 AS CODEMP
    FROM (
        SELECT
            RACK.PESOPEDIDO AS PESO,
            RACK.DATAINI,
            COD_TURNO,
            (
                SELECT SUM(ROUND((PL.DTRET - PL.DTINI) * 24, 2))
                FROM AD_PLINHA PL
                WHERE PL.CODLOC IN (
                    SELECT MAX(CUS.CODCENCUS)
                    FROM TSICUS CUS
                    WHERE CUS.DESCRCENCUS LIKE '%MONTAGEM%'
                )
                AND TO_DATE(PL.DTRET, 'DD/MM/YYYY') = TO_DATE(DATAINI, 'DD/MM/YYYY')
                AND PL.STATUS = 'Finalizado'
            ) AS HRPARADA,
            CAB.CODEMP
        FROM AD_RACK RACK
        LEFT JOIN TGFCAB CAB ON CAB.NUNOTA = RACK.NUNOTA
        LEFT JOIN AD_TGFTURNOS ON (NVL(VIRADIA,'N') = 'S' AND TO_CHAR(DATAINI,'HH24:MI') >= HR_ENTRADA OR
            NVL(VIRADIA,'N') = 'N' AND TO_CHAR(DATAINI,'HH24:MI') BETWEEN HR_ENTRADA AND HR_SAIDA)
        WHERE
            RACK.DATAINI >= $P{DHINICIO}
            AND RACK.DATAINI <= $P{DHFIM}
            AND CAB.CODEMP = $P{CODEMP}
            AND TO_CHAR(TRUNC(RACK.DATAINI), 'D') NOT IN ('1', '7')
    ) T
    GROUP BY TRUNC(T.DATAINI), T.COD_TURNO
),
Faturamento AS (
       SELECT
        1 AS CODPLP,
        ROUND(SUM(T.FATURADO), 2) AS COD_TURNO,
        TRUNC(T.DHINICIO) AS DIA,
        0 AS PESOLOTE,
        0 AS BARRAS,
        0 AS BARRASNC,
        0 AS PESOMEDIO,
        0 AS HRPARADA,
        0 AS META,
        0 AS META_TURNO_1,
        0 AS META_TURNO_2,
        0 AS META_TURNO_3,
        0 AS PERC_FOSCO,
        0 AS PERC_COLORIDO,
        0 AS CODEMP
    FROM (
        SELECT
            SUM(VLRTOT) - MAX(VLRDESCTOT) - MAX(VLRDESCTOTITEM) AS FATURADO,
            CAB.DTNEG AS DHINICIO
        FROM
            TGFCAB CAB
        LEFT JOIN
            TGFITE ITE ON ITE.NUNOTA = CAB.NUNOTA
        WHERE
            ITE.CODPROD IN (6524,6525)
            AND CAB.TIPMOV = 'V'
            AND CAB.CODTIPOPER <> 1713
            AND CAB.STATUSNOTA = 'L'
            AND ITE.QTDNEG <> 0
            AND CAB.DTNEG >= $P{DHINICIO}
            AND CAB.DTNEG <= $P{DHFIM}
            AND CAB.CODEMP = $P{CODEMP}
        GROUP BY
            CAB.DTNEG
    ) T
    GROUP BY TRUNC(T.DHINICIO)
)
SELECT
    TO_CHAR(DIA, 'IW') AS SEMANA,
    MAX(CASE WHEN CODPLP = 40 AND CODEMP = $P{CODEMP} THEN ROUND(META, 2) ELSE 0 END) AS META_ANODIZACAO,
    MAX(CASE WHEN CODPLP = 40 AND CODEMP = $P{CODEMP} THEN ROUND(META * 5, 2) ELSE 0 END) AS META_TOTAL_ANODIZACAO,
    MAX(CASE WHEN CODPLP = 40 AND CODEMP = $P{CODEMP} THEN ROUND(META_TURNO_1, 2) ELSE 0 END) AS META_ANODIZACAO_TURNO_1,
    MAX(CASE WHEN CODPLP = 40 AND CODEMP = $P{CODEMP} THEN ROUND(META_TURNO_2, 2) ELSE 0 END) AS META_ANODIZACAO_TURNO_2,
    MAX(CASE WHEN CODPLP = 40 AND CODEMP = $P{CODEMP} THEN ROUND(META_TURNO_3, 2) ELSE 0 END) AS META_ANODIZACAO_TURNO_3,

    MAX(CASE WHEN CODPLP = 2 AND CODEMP = $P{CODEMP} THEN ROUND(META, 2) ELSE 0 END) AS META_VERTICAL,
    MAX(CASE WHEN CODPLP = 2 AND CODEMP = $P{CODEMP} THEN ROUND(META * 5, 2) ELSE 0 END) AS META_TOTAL_VERTICAL,
    MAX(CASE WHEN CODPLP = 2 AND CODEMP = $P{CODEMP} THEN ROUND(META_TURNO_1, 2) ELSE 0 END) AS META_VERTICAL_TURNO_1,
    MAX(CASE WHEN CODPLP = 2 AND CODEMP = $P{CODEMP} THEN ROUND(META_TURNO_2, 2) ELSE 0 END) AS META_VERTICAL_TURNO_2,
    MAX(CASE WHEN CODPLP = 2 AND CODEMP = $P{CODEMP} THEN ROUND(META_TURNO_3, 2) ELSE 0 END) AS META_VERTICAL_TURNO_3,

    MAX(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND CODEMP = $P{CODEMP} THEN ROUND(META, 2) ELSE 0 END) AS META_HORIZONTAL,
    MAX(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND CODEMP = $P{CODEMP} THEN ROUND(META * 5, 2) ELSE 0 END) AS META_TOTAL_HORIZONTAL,
    MAX(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND CODEMP = $P{CODEMP} THEN ROUND(META_TURNO_1, 2) ELSE 0 END) AS META_HORIZONTAL_TURNO_1,
    MAX(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND CODEMP = $P{CODEMP} THEN ROUND(META_TURNO_2, 2) ELSE 0 END) AS META_HORIZONTAL_TURNO_2,
    MAX(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND CODEMP = $P{CODEMP} THEN ROUND(META_TURNO_3, 2) ELSE 0 END) AS META_HORIZONTAL_TURNO_3,

    MAX(CASE WHEN CODPLP IN (22, 28) AND CODEMP = $P{CODEMP} THEN ROUND(META, 2) ELSE 0 END) AS META_MADEIRA,
    MAX(CASE WHEN CODPLP IN (22, 28) AND CODEMP = $P{CODEMP} THEN ROUND(META * 5, 2) ELSE 0 END) AS META_TOTAL_MADEIRA,
    MAX(CASE WHEN CODPLP IN (22, 28) AND CODEMP = $P{CODEMP} THEN META_TURNO_1 ELSE 0 END) AS META_MADEIRA_TURNO_1,
    MAX(CASE WHEN CODPLP IN (22, 28) AND CODEMP = $P{CODEMP} THEN META_TURNO_2 ELSE 0 END) AS META_MADEIRA_TURNO_2,
    MAX(CASE WHEN CODPLP IN (22, 28) AND CODEMP = $P{CODEMP} THEN META_TURNO_3 ELSE 0 END) AS META_MADEIRA_TURNO_3,

    -- Anodizacao
    -- Segunda-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 1 THEN PERC_FOSCO ELSE 0 END) AS PERC_FOSCO_TURNO_1_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 1 THEN PERC_COLORIDO ELSE 0 END) AS PERC_COLORIDO_TURNO_1_SEGUNDA_ANODIZACAO,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 2 THEN PERC_FOSCO ELSE 0 END) AS PERC_FOSCO_TURNO_2_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 2 THEN PERC_COLORIDO ELSE 0 END) AS PERC_COLORIDO_TURNO_2_SEGUNDA_ANODIZACAO,


    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 3 THEN PERC_FOSCO ELSE 0 END) AS PERC_FOSCO_TURNO_3_SEGUNDA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP = 40 AND COD_TURNO = 3 THEN PERC_COLORIDO ELSE 0 END) AS PERC_COLORIDO_TURNO_3_SEGUNDA_ANODIZACAO,


    -- TerÃ§a-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 1 THEN PERC_FOSCO ELSE 0 END) AS PERC_FOSCO_TURNO_1_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 1 THEN PERC_COLORIDO ELSE 0 END) AS PERC_COLORIDO_TURNO_1_TERCA_ANODIZACAO,


    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 2 THEN PERC_FOSCO ELSE 0 END) AS PERC_FOSCO_TURNO_2_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 2 THEN PERC_COLORIDO ELSE 0 END) AS PERC_COLORIDO_TURNO_2_TERCA_ANODIZACAO,



    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 3 THEN PERC_FOSCO ELSE 0 END) AS PERC_FOSCO_TURNO_3_TERCA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP = 40 AND COD_TURNO = 3 THEN PERC_COLORIDO ELSE 0 END) AS PERC_COLORIDO_TURNO_3_TERCA_ANODIZACAO,

    -- Quarta-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 1 THEN PERC_FOSCO ELSE 0 END) AS PERC_FOSCO_TURNO_1_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 1 THEN PERC_COLORIDO ELSE 0 END) AS PERC_COLORIDO_TURNO_1_QUARTA_ANODIZACAO,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 2 THEN PERC_FOSCO ELSE 0 END) AS PERC_FOSCO_TURNO_2_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 2 THEN PERC_COLORIDO ELSE 0 END) AS PERC_COLORIDO_TURNO_2_QUARTA_ANODIZACAO,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 3 THEN PERC_FOSCO ELSE 0 END) AS PERC_FOSCO_TURNO_3_QUARTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 40 AND COD_TURNO = 3 THEN PERC_COLORIDO ELSE 0 END) AS PERC_COLORIDO_TURNO_3_QUARTA_ANODIZACAO,

    -- Quinta-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 1 THEN PERC_FOSCO ELSE 0 END) AS PERC_FOSCO_TURNO_1_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 1 THEN PERC_COLORIDO ELSE 0 END) AS PERC_COLORIDO_TURNO_1_QUINTA_ANODIZACAO,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 2 THEN PERC_FOSCO ELSE 0 END) AS PERC_FOSCO_TURNO_2_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 2 THEN PERC_COLORIDO ELSE 0 END) AS PERC_COLORIDO_TURNO_2_QUINTA_ANODIZACAO,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 3 THEN PERC_FOSCO ELSE 0 END) AS PERC_FOSCO_TURNO_3_QUINTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP = 40 AND COD_TURNO = 3 THEN PERC_COLORIDO ELSE 0 END) AS PERC_COLORIDO_TURNO_3_QUINTA_ANODIZACAO,


    -- Sexta-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 1 THEN PERC_FOSCO ELSE 0 END) AS PERC_FOSCO_TURNO_1_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 1 THEN PERC_COLORIDO ELSE 0 END) AS PERC_COLORIDO_TURNO_1_SEXTA_ANODIZACAO,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 2 THEN PERC_FOSCO ELSE 0 END) AS PERC_FOSCO_TURNO_2_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 2 THEN PERC_COLORIDO ELSE 0 END) AS PERC_COLORIDO_TURNO_2_SEXTA_ANODIZACAO,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 3 THEN PERC_FOSCO ELSE 0 END) AS PERC_FOSCO_TURNO_3_SEXTA_ANODIZACAO,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP = 40 AND COD_TURNO = 3 THEN PERC_COLORIDO ELSE 0 END) AS PERC_COLORIDO_TURNO_3_SEXTA_ANODIZACAO,

    SUM(CASE WHEN CODPLP = 40 THEN PESOLOTE ELSE 0 END) AS PESO_TOTAL_SEMANA_ANODIZACAO,
    SUM(CASE WHEN CODPLP = 40 THEN BARRAS ELSE 0 END) AS BARRAS_TOTAL_SEMANA_ANODIZACAO,
    SUM(CASE WHEN CODPLP = 40 THEN BARRASNC ELSE 0 END) AS BARRASNC_TOTAL_SEMANA_ANODIZACAO,
    SUM(CASE WHEN CODPLP = 40 THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_SEMANA_ANODIZACAO,
    ROUND(
        (SUM(CASE WHEN CODPLP = 40 THEN PESOLOTE ELSE 0 END) /
         NULLIF(MAX(CASE WHEN CODPLP = 40 THEN META * 5 ELSE 0 END), 0)) * 100,
        2
    ) AS PERFORMANCE_TOTAL_SEMANA_ANODIZACAO,
    ROUND(
        (SUM(CASE WHEN CODPLP = 40 THEN BARRASNC ELSE 0 END) /
         NULLIF(SUM(CASE WHEN CODPLP = 40 THEN BARRAS ELSE 0 END), 0)) * 100,
        2
    ) AS INDICENC_TOTAL_SEMANA_ANODIZACAO,
    ROUND(
        SUM(CASE WHEN CODPLP = 40 THEN PESOLOTE ELSE 0 END) /
        NULLIF(SUM(CASE WHEN CODPLP = 40 THEN BARRAS ELSE 0 END), 0),
        2
    ) AS PESOMEDIO_TOTAL_SEMANA_ANODIZACAO,
    SUM(CASE WHEN CODPLP = 40 THEN PERC_FOSCO / 5 ELSE 0 END) AS PERC_FOSCO_TOTAL_SEMANA_ANODIZACAO,
    SUM(CASE WHEN CODPLP = 40 THEN PERC_COLORIDO / 5 ELSE 0 END) AS PERC_COLORIDO_TOTAL_SEMANA_ANODIZACAO,

    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (40) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_SEGUNDA_ANODIZACAO,
    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (40) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_TERCA_ANODIZACAO,
    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (40) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_QUARTA_ANODIZACAO,
    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (40) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_QUINTA_ANODIZACAO,
    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (40) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_SEXTA_ANODIZACAO,

    -- Vertical
    -- Segunda-feira

     MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_SEGUNDA_VERTICAL,


    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_SEGUNDA_VERTICAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_SEGUNDA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP      IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_SEGUNDA_VERTICAL,

    -- TerÃ§a-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_TERCA_VERTICAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_TERCA_VERTICAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_TERCA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_TERCA_VERTICAL,

    -- Quarta-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_QUARTA_VERTICAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP = 2 AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_QUARTA_VERTICAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_QUARTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_QUARTA_VERTICAL,

    -- Quinta-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_QUINTA_VERTICAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_QUINTA_VERTICAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_QUINTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_QUINTA_VERTICAL,


    -- Sexta-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_SEXTA_VERTICAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_SEXTA_VERTICAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_SEXTA_VERTICAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))   AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_SEXTA_VERTICAL,


    SUM(CASE WHEN CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  THEN PESOLOTE ELSE 0 END) AS PESO_TOTAL_SEMANA_VERTICAL,
    SUM(CASE WHEN CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  THEN BARRAS ELSE 0 END) AS BARRAS_TOTAL_SEMANA_VERTICAL,
    SUM(CASE WHEN CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  THEN BARRASNC ELSE 0 END) AS BARRASNC_TOTAL_SEMANA_VERTICAL,
    SUM(CASE WHEN CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_SEMANA_VERTICAL,
    ROUND(
        SUM(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3)) THEN PESOLOTE ELSE 0 END) /
        NULLIF(SUM(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3)) THEN BARRAS ELSE 0 END), 0),
        2
    ) AS PESOMEDIO_TOTAL_SEMANA_VERTICAL,
    SUM(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3)) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_SEMANA_VERTICAL,
    ROUND(
        (SUM(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3)) THEN PESOLOTE ELSE 0 END) /
         NULLIF(MAX(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3)) THEN ROUND(META * 5, 2) ELSE 0 END), 0)) * 100,
        2
    ) AS PERFORMANCE_TOTAL_SEMANA_VERTICAL,
    ROUND(
        (SUM(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3)) THEN BARRASNC ELSE 0 END) /
         NULLIF(SUM(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3)) THEN BARRAS ELSE 0 END), 0)) * 100,
        2
    ) AS INDICENC_TOTAL_SEMANA_VERTICAL,

    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_SEGUNDA_VERTICAL,
    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_TERCA_VERTICAL,
    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_QUARTA_VERTICAL,
    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_QUINTA_VERTICAL,
    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP     IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (3))  THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_SEXTA_VERTICAL,

    -- Horizontal
    -- Segunda-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_SEGUNDA_HORIZONTAL,


    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_SEGUNDA_HORIZONTAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_SEGUNDA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_SEGUNDA_HORIZONTAL,

    -- TerÃ§a-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_TERCA_HORIZONTAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_TERCA_HORIZONTAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_TERCA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_TERCA_HORIZONTAL,

    -- Quarta-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_QUARTA_HORIZONTAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_QUARTA_HORIZONTAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_QUARTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_QUARTA_HORIZONTAL,

    -- Quinta-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_QUINTA_HORIZONTAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_QUINTA_HORIZONTAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_QUINTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_QUINTA_HORIZONTAL,


    -- Sexta-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_SEXTA_HORIZONTAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_SEXTA_HORIZONTAL,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_SEXTA_HORIZONTAL,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_SEXTA_HORIZONTAL,


        SUM(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) THEN PESOLOTE ELSE 0 END) AS PESO_TOTAL_SEMANA_HORIZONTAL,
    SUM(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) THEN BARRAS ELSE 0 END) AS BARRAS_TOTAL_SEMANA_HORIZONTAL,
    SUM(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) THEN BARRASNC ELSE 0 END) AS BARRASNC_TOTAL_SEMANA_HORIZONTAL,
    SUM(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TOTAL_SEMANA_HORIZONTAL,
    SUM(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_SEMANA_HORIZONTAL,
    ROUND(
        SUM(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) THEN PESOLOTE ELSE 0 END) /
        NULLIF(SUM(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4))  THEN BARRAS ELSE 0 END), 0),
        2
    ) AS PESOMEDIO_TOTAL_SEMANA_HORIZONTAL,
    ROUND(
        (SUM(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) THEN PESOLOTE ELSE 0 END) /
         NULLIF(MAX(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) THEN META * 5 ELSE 0 END), 0)) * 100,
        2
    ) AS PERFORMANCE_TOTAL_SEMANA_HORIZONTAL,
    ROUND(
        (SUM(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) THEN BARRASNC ELSE 0 END) /
         NULLIF(SUM(CASE WHEN CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) THEN BARRAS ELSE 0 END), 0)) * 100,
        2
    ) AS INDICENC_TOTAL_SEMANA_HORIZONTAL,

    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_SEGUNDA_HORIZONTAL,
    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_TERCA_HORIZONTAL,
    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_QUARTA_HORIZONTAL,
    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_QUINTA_HORIZONTAL,
    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP IN (SELECT CODPLP FROM AD_PARPROD WHERE CODSETOR IN (2, 4)) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_SEXTA_HORIZONTAL,


   -- Efeito Madeira
   -- Segunda-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (22, 28)  AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (22, 28)  AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (22, 28) AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (22, 28) AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (22, 28) AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (22, 28) AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP IN (22, 28) AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_SEGUNDA_MADEIRA,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_SEGUNDA_MADEIRA,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_SEGUNDA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_SEGUNDA_MADEIRA,

    -- TerÃ§a-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (22, 28) AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (22, 28) AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (22, 28) AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (22, 28) AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (22, 28) AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (22, 28) AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (22, 28) AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_TERCA_MADEIRA,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (22, 28) AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (22, 28) AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (22, 28) AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (22, 28) AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (22, 28) AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP IN (22, 28) AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_TERCA_MADEIRA,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_TERCA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_TERCA_MADEIRA,

    -- Quarta-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_QUARTA_MADEIRA,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_QUARTA_MADEIRA   ,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_QUARTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_QUARTA_MADEIRA,

    -- Quinta-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_QUINTA_MADEIRA,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_QUINTA_MADEIRA,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_QUINTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_QUINTA_MADEIRA,


    -- Sexta-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_1_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_1_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_1_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_1, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_1_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 1 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_1_SEXTA_MADEIRA,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_2_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_2_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_2_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_2, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_2_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 2 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_2_SEXTA_MADEIRA,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN BARRAS ELSE 0 END) AS BARRAS_TURNO_3_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN BARRASNC ELSE 0 END) AS BARRASNC_TURNO_3_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN PESOMEDIO ELSE 0 END) AS PESOMEDIO_TURNO_3_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN
        ROUND((PESOLOTE / NULLIF(META_TURNO_3, 0)) * 100, 2) ELSE 0 END) AS PERFORMANCE_TURNO_3_SEXTA_MADEIRA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) AND COD_TURNO = 3 THEN
        ROUND((BARRASNC / NULLIF(BARRAS, 0)) * 100, 2) ELSE 0 END) AS INDICENC_TURNO_3_SEXTA_MADEIRA,

    SUM(CASE WHEN CODPLP  IN (22, 28) THEN PESOLOTE ELSE 0 END) AS PESO_TOTAL_SEMANA_MADEIRA,
    SUM(CASE WHEN CODPLP  IN (22, 28) THEN BARRAS ELSE 0 END) AS BARRAS_TOTAL_SEMANA_MADEIRA,
    SUM(CASE WHEN CODPLP  IN (22, 28) THEN BARRASNC ELSE 0 END) AS BARRASNC_TOTAL_SEMANA_MADEIRA,
    SUM(CASE WHEN CODPLP  IN (22, 28) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_SEMANA_MADEIRA,
    ROUND(
        SUM(CASE WHEN CODPLP IN (22, 28) THEN PESOLOTE ELSE 0 END) /
        NULLIF(SUM(CASE WHEN CODPLP IN (22, 28) THEN BARRAS ELSE 0 END), 0),
        2
    ) AS PESOMEDIO_TOTAL_SEMANA_MADEIRA,
    ROUND(
        (SUM(CASE WHEN CODPLP IN (22, 28) THEN PESOLOTE ELSE 0 END) /
         NULLIF(MAX(CASE WHEN CODPLP IN (22, 28) THEN META * 5 ELSE 0 END), 0)) * 100,
        2
    ) AS PERFORMANCE_TOTAL_SEMANA_MADEIRA,
    ROUND(
        (SUM(CASE WHEN CODPLP IN (22, 28) THEN BARRASNC ELSE 0 END) /
         NULLIF(SUM(CASE WHEN CODPLP IN (22, 28) THEN BARRAS ELSE 0 END), 0)) * 100,
        2
    ) AS INDICENC_TOTAL_SEMANA_MADEIRA,

    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 2 AND CODPLP  IN (22, 28) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_SEGUNDA_MADEIRA,
    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 3 AND CODPLP  IN (22, 28) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_TERCA_MADEIRA,
    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 4 AND CODPLP  IN (22, 28) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_QUARTA_MADEIRA,
    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 5 AND CODPLP  IN (22, 28) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_QUINTA_MADEIRA,
    SUM(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE= ''Portuguese''') = 6 AND CODPLP  IN (22, 28) THEN HRPARADA ELSE 0 END) AS HRPARADA_TOTAL_SEXTA_MADEIRA,


    -- Montagem rack
    -- Segunda-feira

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 2 AND CODPLP = 0 AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_SEGUNDA_MONTAGEM,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 2 AND CODPLP = 0 AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_SEGUNDA_MONTAGEM,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 2 AND CODPLP = 0 AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_SEGUNDA_MONTAGEM,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 2 AND CODPLP = 0 AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_SEGUNDA_MONTAGEM,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 2 AND CODPLP = 0 AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_SEGUNDA_MONTAGEM,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 2 AND CODPLP = 0 AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_SEGUNDA_MONTAGEM,

    -- TerÃ§a-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 3 AND CODPLP = 0 AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_TERCA_MONTAGEM,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 3 AND CODPLP = 0 AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_TERCA_MONTAGEM,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 3 AND CODPLP = 0 AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_TERCA_MONTAGEM,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 3 AND CODPLP = 0 AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_TERCA_MONTAGEM,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 3 AND CODPLP = 0 AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_TERCA_MONTAGEM,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 3 AND CODPLP = 0 AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_TERCA_MONTAGEM,

    -- Quarta-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 4 AND CODPLP = 0 AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_QUARTA_MONTAGEM,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 4 AND CODPLP = 0 AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_QUARTA_MONTAGEM,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 4 AND CODPLP = 0 AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_QUARTA_MONTAGEM,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 4 AND CODPLP = 0 AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_QUARTA_MONTAGEM,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 4 AND CODPLP = 0 AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_QUARTA_MONTAGEM,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 4 AND CODPLP = 0 AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_QUARTA_MONTAGEM,

    -- Quinta-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 5 AND CODPLP = 0 AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_QUINTA_MONTAGEM,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 5 AND CODPLP = 0 AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_QUINTA_MONTAGEM,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 5 AND CODPLP = 0 AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_QUINTA_MONTAGEM,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 5 AND CODPLP = 0 AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_QUINTA_MONTAGEM,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 5 AND CODPLP = 0 AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_QUINTA_MONTAGEM,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 5 AND CODPLP = 0 AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_QUINTA_MONTAGEM,

    -- Sexta-feira
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 6 AND CODPLP = 0 AND COD_TURNO = 1 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_1_SEXTA_MONTAGEM,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 6 AND CODPLP = 0 AND COD_TURNO = 1 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_1_SEXTA_MONTAGEM,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 6 AND CODPLP = 0 AND COD_TURNO = 2 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_2_SEXTA_MONTAGEM,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 6 AND CODPLP = 0 AND COD_TURNO = 2 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_2_SEXTA_MONTAGEM,

    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 6 AND CODPLP = 0 AND COD_TURNO = 3 THEN PESOLOTE ELSE 0 END) AS PESO_TURNO_3_SEXTA_MONTAGEM,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 6 AND CODPLP = 0 AND COD_TURNO = 3 THEN HRPARADA ELSE 0 END) AS HRPARADA_TURNO_3_SEXTA_MONTAGEM,


    SUM(CASE WHEN CODPLP = 0  THEN PESOLOTE ELSE 0 END) AS PESO_TOTAL_MONTAGEM,
    SUM(CASE WHEN CODPLP = 0 THEN NVL(HRPARADA, 0) ELSE 0 END) AS HRPARADA_TOTAL_MONTAGEM,


    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 2 AND CODPLP = 1 THEN COD_TURNO ELSE 0 END) AS FATURAMENTO_SEGUNDA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 3 AND CODPLP = 1 THEN COD_TURNO ELSE 0 END) AS FATURAMENTO_TERCA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 4 AND CODPLP = 1 THEN COD_TURNO ELSE 0 END) AS FATURAMENTO_QUARTA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 5 AND CODPLP = 1 THEN COD_TURNO ELSE 0 END) AS FATURAMENTO_QUINTA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 6 AND CODPLP = 1 THEN COD_TURNO ELSE 0 END) AS FATURAMENTO_SEXTA,
    MAX(CASE WHEN TO_CHAR(DIA, 'D', 'NLS_DATE_LANGUAGE=''Portuguese''') = 2 AND CODPLP = 1 THEN COD_TURNO ELSE 0 END) AS FATURAMENTO_SEGUNDA,

    SUM(CASE WHEN CODPLP = 1 THEN COD_TURNO ELSE 0 END) AS FATURAMENTO_TOTAL_SEMANA


FROM (
    SELECT 'Madeira' AS TABELA, COD_TURNO, CODPLP, DIA, META, META_TURNO_1, META_TURNO_2, META_TURNO_3, PESOLOTE, BARRAS, BARRASNC, PESOMEDIO, HRPARADA, PERC_FOSCO, PERC_COLORIDO, CODEMP FROM Madeira
    UNION ALL
    SELECT 'Vertical' AS TABELA, COD_TURNO, CODPLP, DIA, META, META_TURNO_1, META_TURNO_2, META_TURNO_3, PESOLOTE, BARRAS, BARRASNC, PESOMEDIO, HRPARADA, PERC_FOSCO, PERC_COLORIDO, CODEMP FROM Vertical
    UNION ALL
    SELECT 'Horizontal' AS TABELA, COD_TURNO, CODPLP, DIA, META, META_TURNO_1, META_TURNO_2, META_TURNO_3, PESOLOTE, BARRAS, BARRASNC, PESOMEDIO, HRPARADA, PERC_FOSCO, PERC_COLORIDO, CODEMP  FROM Horizontal
    UNION ALL
    SELECT 'Anodizacao' AS TABELA, COD_TURNO, CODPLP, DIA, META, META_TURNO_1, META_TURNO_2, META_TURNO_3, PESOLOTE, BARRAS, BARRASNC, PESOMEDIO, HRPARADA, PERC_FOSCO, PERC_COLORIDO, CODEMP FROM Anodizacao
    UNION ALL
    SELECT 'Montagem' AS TABELA, COD_TURNO, CODPLP, DIA, META, META_TURNO_1, META_TURNO_2, META_TURNO_3, PESOLOTE, BARRAS, BARRASNC, PESOMEDIO, HRPARADA, PERC_FOSCO, PERC_COLORIDO, CODEMP FROM MontagemRack
    UNION ALL
    SELECT 'Faturamento' AS TABELA, COD_TURNO, CODPLP, DIA, META, META_TURNO_1, META_TURNO_2, META_TURNO_3, PESOLOTE, BARRAS, BARRASNC, PESOMEDIO, HRPARADA, PERC_FOSCO, PERC_COLORIDO, CODEMP FROM Faturamento
)
GROUP BY TO_CHAR(DIA, 'IW')
ORDER BY SEMANA